<!-- REFERENCES -->

<!--   
1) Holtz, Y. (2022). Input data transition for d3.js line chart. D3-graph-gallery.com. [online] 
Available at: https://www.d3-graph-gallery.com/graph/line_change_data.html
-->



<!DOCTYPE html>

<html lang = "en">
    <head>
        <script src='https://d3js.org/d3.v7.min.js'></script>
    </head>


    <body>
        <script type='text/javascript' src='https://d3js.org/d3.v7.min.js'></script>

        <button onclick="showLine(data1, color1)">Line Graph 1</button>
        <button onclick="showLine(data2, color2)">Line Graph 2</button>

        <script>

            const color1 = "#32B480"
            const color2 = "#AA1945"

            const data1 = [
                {group: "Jan", value: 19},
                {group: "Feb", value: 21},
                {group: "Mar", value: 26},
                {group: "Apr", value: 28},
                {group: "May", value: 22},
                {group: "Jun", value: 26},
                {group: "Jul", value: 16},
                {group: "Aug", value: 25},
                {group: "Sep", value: 18}
            ];

            const data2 = [
                {group: "Dec", value: 43},
                {group: "Jan", value: 48},
                {group: "Feb", value: 51},
                {group: "Mar", value: 52},
                {group: "Apr", value: 49},
                {group: "May", value: 53},
                {group: "Jun", value: 41},
                {group: "Jul", value: 48},
                {group: "Aug", value: 0}
            ];

            var c = 0;
            // set the dimensions and margins of the graph
            const margin = {top: 30, right: 30, bottom: 70, left: 60};
            const width = 460 - margin.left - margin.right;
            const height = 400 - margin.top - margin.bottom;

            // append the svg object to the body of the page
            var svg = d3.select('body')
                        .append('div')
                        .append("svg")
                        .attr("width", width + margin.left + margin.right)
                        .attr("height", height + margin.top + margin.bottom)
                        .append("g")
                        .attr("transform",
                        "translate(" + margin.left + "," + margin.top + ")");

            // Add X axis
            var x = d3.scaleBand()
                        .range([0, width])
                        .padding(0.2)

            var xBottomAxis = d3.axisBottom()
                                .scale(x)

            var x_bottom = svg.append("g")
                                .attr("transform", "translate(0," + height + ")")
                                .call(xBottomAxis)

            var xTopAxis = d3.axisTop()
                              .scale(x)

            var x_top = svg.append("g")
                            .call(xTopAxis)

            var y = d3.scaleLinear()
                        .domain([0, 60])
                        .range([ height, 0]);

            var yLeftAxis = d3.axisLeft()
                                .scale(y)

            var y_left = svg.append("g")
                            .attr("class", "myYaxis")
                            .call(yLeftAxis);

            var yRightAxis = d3.axisRight()
                                .scale(y)

            var y_right = svg.append("g")
                            .attr("class", "myYaxis")
                            .attr("transform", "translate(" + width + ", 0)")
                            .call(yRightAxis); 

            // var circle = svg.selectAll("circle")
            //                 .data(data)
            //                 .enter()
            //                 .append("circle")
            //                 .attr("r", 5)

            function axes(data){
                        
                        x.domain(data.map(function(d) {            //(Holtz, 2022)
                            return d.group; 
                        }))
                        
                        xBottomAxis = d3.axisBottom()
                                            .scale(x)

                        x_bottom.transition()                  //(Holtz, 2022)
                            .duration(1000)
                            .call(xBottomAxis)

                        xTopAxis = d3.axisTop()
                                      .scale(x)
                        
                        // alert(height)
                        x_top.transition()               //(Holtz, 2022)
                            .duration(1000)
                            .call(xTopAxis)
                
            }

            function showLine(data, color) {

                axes(data);
                // , function(d){           //(Holtz, 2022)
                //                 return d.group 
                //             }
                var u = svg.selectAll(".line")
                            .data([data]);

                u.enter()
                    .append("path")
                    .attr("class","line")
                    .merge(u)
                    .transition()
                    .duration(1000)
                    .attr("fill", "none")
                    .attr("stroke", color)
                    .attr("stroke-width", 1.5)
                    .attr("d", d3.line()
                    .x(function(d){
                        return x(d.group) + 15;
                    })
                    .y(function(d){
                        return y(d.value);
                    })
                   )

                   showDots(data, color)
                

                u.exit().remove()
                
                
            }

            function showDots(data, color){

                var v = svg.selectAll(".point")
                            .data(data)

                v.enter()
                   .append("circle")
                   .attr("class","point")
                   .merge(v)
                   .transition()
                    .duration(1000)
                   .attr("cx", function(d){
                       //alert(x(d))
                       return x(d.group) +15;
                   })
                //    .transition()
                //     .duration(500)
                   .attr("cy", function(d){
                       return y(d.value);
                   })
                   .attr("r", 5)
                   
                   .attr("fill", color);

                   v.exit().remove();
            }

            showLine(data1 , color1)                                               
        </script>

        <button onclick="window.location.href='Part 5 ex18 ex19 ex21 ex22.html'">Click for Bar Chart</button>
    </body>
</html>